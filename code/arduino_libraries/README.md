# Libraries
This folder contains all the libraries needed for programming an EnviroDIY Mayfly datalogger for the CIROH Advancing Snow Observations project. **These libraries are a copy.** These libraries are a composition of what the EnvrioDIY team has developed and the libraries their code depends on: https://github.com/EnviroDIY/Libraries. There are some that are not the most current version of the original developers' code. That means that after you copy these libraries over into your Arduino/libraries folder in your Documents, the Arduino IDE may ask if you would like to update the libraries you have. You should not do the update, or at least update them manually and only update the libraries that you know will not have new coding that will interfere with the functionality of your Mayfly.

### What to do with these libraries

Simply copy all the contents in this directory (folders and stand-alone files), and paste them in your Arduino\libraries folder (most likely found in your Documents, but may be different if you chose to store it in a different location when setting up your Arduino IDE).

### Description of libraries

You may notice that there are several libraries, and by extension, source code that is not used in this project, such as various sensors. These libraries from the original EnviroDIY repository and have been left in this repository. That is because there are many dependencies that we are not familiar with that the Mayfly may have, and it keeps the door open for adding on additional sensors and applying the work done for this project to other hydrologic implementations. It is safer and more efficient to leave the entire contents in the repository rather than sift through what is needed and what isn't. These extra libraries will not occupy any extra space on your Mayfly because they will not be called. There are discrepencies found between this directory of libraries and EnviroDIY's version. EnviroDIY may add new libraries as they expand their functionality. This repository has modified code and has some additional libraries in case you want to do some unique troubleshooting. Just keep in mind that the purpose of using the libraries found in this repository is for the implementation of a snow sensing station in the context of the CIROH Advancing Snow Observations project. We cannot guaruntee that these libraries will function for other projects as code and hardware develop outside this project. 

The following four sections are some summaries of the various libraries found here as described by EnvrioDIY in their Libraries repository that this originates from (https://github.com/EnviroDIY/Libraries). These sections are taken directly from the README.md file found in that repository. Any special comments made in regards to these libraries, or additional libraries not found in the original EnviroDIY repository, that may be of interest are noted in *italics*. The links take you to where the libraries originate.

#### These libraries are for basic components built into the EnviroDIYMayfly:
* [soligen2010 fork of Adafruit ADS1x15](https://github.com/soligen2010/Adafruit_ADS1X15) - Includes the drivers for the auxillary ADC [TI's ADS1115 chip](http://www.ti.com/product/ADS1115) which is built into the Mayfly board. (The ADS115 is a 16-bit analog-to-digital converter (ADC) with a programmable gain amplifier (PGA) and digital comparator.)  This fork fixes bugs in the Adafruit version and should be used instead of the version direct from Adafruit. *This library is used extensively for the Adafruit ADCs on the Mayfly itself and the for the extras used for the pyrgeometers.*
* [EnviroDIY DS3231](https://github.com/EnviroDIY/Sodaq_DS3231) - A fork of the Sodaq library which controls the [DS3231](https://www.maximintegrated.com/en/products/digital/real-time-clocks/DS3231.html) I2C Real Time Clock (RTC) built into the EnviroDIY Mayfly.


#### These libraries are likely to be helpful when using the Mayfly as a sleeping logger:
* [EnviroDIY Modular Sensors](https://github.com/EnviroDIY/ModularSensors) - A class-subclass setup allowing many sensors to be called with the same commands.  This library is dependent on many of the other libraries listed here. *This library is where where everything really comes together for seamless datalogging, and the EnviroDIY team has done extensive work in making this library as functional and digestible as possible. All the primary source code for sensors and measurments are found here. Understanding the structure and function of this library is not necessary to successfully deploy a snow sensing station, but doing so will greatly help you troubleshoot and expand the work done in this project to other applications.*
* [Sodaq RTCTimer](https://github.com/SodaqMoja/RTCTimer) - Works with the DS3231 to easily perform scheduled tasks.  This library does not handle sleeping and is intended for use with a continously awake logger. *This library is used for the central station's Mayfly if you choose to do a networking setup with XBee radios.*
* [SdFat](https://github.com/greiman/SdFat) - Communicates with the on-board SD card to read and save data on the card.  This is a more efficient and more feature rich replacement of the built-in SD library. *This library is used in ModularSensors, but also in a utilities file that helps to download data from a microSD card.*
* [EnableInterrupt](https://github.com/EnviroDIY/EnableInterrupt) - Administrates and handles both "external" and "pin change" interrupts on the Atmel microcontroller built into the Mayfly.  This allows to Mayfly to sleep and save battery.  This library also works well as a controller for the versions of SoftwareSerial and SDI-12 linked below that have been stripped of interrupt control.
* [Sodaq PCInt](https://github.com/SodaqMoja/Sodaq_PcInt) - Another simpler library that can administrate pin change interrupts.
* [EnviroDIY_GPRSbee](https://github.com/EnviroDIY/GPRSbeeMod/tree/v1.2_hacked) - Communicates with the [Sodaq GPRSBee](https://www.seeedstudio.com/GPRSbee-rev.-6-p-2445.html#) to send data over cellular network.  This library is an older version of the Sodaq library that has been hacked to work with both rev0.4 and rev0.6 of the GPRSbee.  Further work is required to make the current Sodaq GPRSbee library work on the EnviroDIY Mayfly.
* [Tiny GSM](https://github.com/EnviroDIY/TinyGSM.git) - A smaller GSM communication library that supports, among others, [Sodaq's GPRSBee](https://shop.sodaq.com/en/gprsbee.html), Digi's [LTE](https://www.digi.com/products/xbee-rf-solutions/embedded-rf-modules-modems/digi-xbee-cellular) and [WiFi](https://www.digi.com/products/xbee-rf-solutions/embedded-rf-modules-modems/xbee-wi-fi) XBees, and ESP8266 based WiFi-XBee's like [Itead's Wee](https://www.itead.cc/wiki/Wee_Serial_WIFI_Module) or [DFRobot's Wifi Bee](https://www.dfrobot.com/product-1279.html).  This library is more compact (and possibly easier to use) than the [EnviroDIY_GPRSbee](https://github.com/EnviroDIY/GPRSbeeMod/tree/v1.2_hacked) and supports many more modules, but does not include direct support for putting the modems to sleep.  The "ModemSupport" module of the [EnviroDIY Modular Sensors](https://github.com/EnviroDIY/ModularSensors) library does adds that.


#### These libraries are used communicate with sensors and peripherals:
* [AltSoftSerial](https://github.com/PaulStoffregen/AltSoftSerial) - Improved software emulated serial, using hardware timers for precise signal timing and availability of CPU time for other libraries to respond to interrupts during data transmission and reception. *This library is used for the MaxBotix sonar sensor.*
* [EnviroDIY SDI-12](https://github.com/EnviroDIY/Arduino-SDI-12) - Implements the [SDI-12](https://en.wikipedia.org/wiki/SDI-12) communications protocol that is used by a wide variety of environmental sensors. *The METER TEROS 12 sensors use this protocol, and by extension, this library.*
* [SensorModbusMaster](https://github.com/EnviroDIY/SensorModbusMaster) - Implements the [Modbus RTU](https://en.wikipedia.org/wiki/Modbus) communications protocol that is used by a wide variety of industrial sensors.
* [Adafruit Sensor](https://github.com/adafruit/Adafruit_Sensor) - Adafruit unified sensor library/driver used by many of Adafruit's other sensor libraries.
* [Adafruit DHT](https://github.com/adafruit/DHT-sensor-library) - Controls the low cost [AOSong DHT11, DHT21, AM2301, DHT22, or AM2302](http://www.aosong.com/en/products/index.asp) temperature & humidity sensors sold by [Adafruit](https://www.adafruit.com/products/385) and others.
* [Adafruit TSL2561](https://github.com/Adafruit/TSL2561-Arduino-Library/) - Controls the Adafruit [TSL2561](https://www.adafruit.com/products/439) digital luminosity sensor.
* [Adafruit AM2315](https://github.com/adafruit/Adafruit_AM2315) - Controls and communicates with an [AOSong AM2315](www.aosong.com/asp_bin/Products/en/AM2315.pdf) encased I2C temperature and humidity sensor
* [*Adafruit INA260*](https://github.com/adafruit/Adafruit_INA260) - *This library is used for measuring current with the* [*Adafruit INA260 sensor*](https://www.adafruit.com/product/4226). *This is handy for battery sizing, and the associated utilities file is found* [*here*](https://github.com/CIROH-Snow/snow_sensing/tree/main/code/utilities/measure_amps).
* [Adafruit BME280 Library](https://github.com/adafruit/Adafruit_BME280_Library) - Controls and communicates with a [Bosch BME280](https://www.bosch-sensortec.com/bst/products/all_products/bme280) humidity, barometric pressure and temperature sensor.
- [Adafruit MPL115A2 library](https://github.com/adafruit/Adafruit_MPL115A2) - Controls and communicates with a [Freescale Semiconductor MPL115A2](https://www.nxp.com/docs/en/data-sheet/MPL115A2.pdf) Miniature I2C Digital Barometer
* [OneWire](https://github.com/PaulStoffregen/OneWire) - Lets you access 1-wire devices made by Maxim/Dallas, such as temperature sensors and ibutton secure memory. For temperature sensors, the DallasTemperature library can be used with this library.
* [Dallas Temperature](https://github.com/milesburton/Arduino-Temperature-Control-Library) - Arduino plug and go library for the Maxim (previously Dallas) DS18B20 (and similar) temperature ICs
* [SDL SSD1306](https://github.com/switchdoclabs/SDL_Arduino_SSD1306)  - Controls the SwitchDoc Labs Grove [128x64 OLED](http://store.switchdoc.com/grove-128x64-i2c-oled-board-for-arduino-and-raspberry-pi/).
* [RTCZero](https://github.com/arduino-libraries/RTCZero) - This library is _NOT_ compatible with the EnviroDIY Mayfly, but is included for convenience for anyone using a SAMD board.  This controls the real time clock and sleep modes for Atmel SAMD21 boards.
* [Northern Widget MS5803 Library](https://github.com/NorthernWidget/MS5803) - Communicates with a Measurement Specialties MS5803 pressure sensor
* [EnviroDIY KellerModbus Library](https://github.com/EnviroDIY/KellerModbus) - for all Keller modbus pressure and water level sensors.
* [EnviroDIY YosemitechModbus](https://github.com/EnviroDIY/YosemitechModbus) - Communicates with [Yosemitech](http://www.yosemitech.com/en/) brand modbus sensors.
* [NeoSWSerial](https://github.com/SRGDamia1/NeoSWSerial.git) - Yet another serial port emulator



#### These libraries are modified versions that are necessary in order to work together:

These modified versions are necessary because each of these libraries will try to simultaneously monitor all pin change interrupt vectors on any Arduino board causing compiler errors.  Instead of allowing them to handle interrupts on their own, these have been stripped of interrupt vector control and require and external pin change interrupt to set up their interrupts for them.  The modified versions are only necessary to use two or more of these together.  Any pin that supports pin change interrupts can be used with these libraries, provided that you use [EnableInterrupt](https://github.com/EnviroDIY/EnableInterrupt) or another library to allow them interrupt control.  These can also be used with other AVR boards (including the Arduino Uno, Mega, or Leonardo).
* [EnviroDIY SoftwaterSerial_ExtInts](https://github.com/EnviroDIY/SoftwaterSerial_ExternalInts)
* [EnviroDIY SDI-12_ExtInts](https://github.com/EnviroDIY/Arduino-SDI-12/tree/ExtInts)

Instead of being controlled by an alternate library, these versions have been cropped to only look at only one interrupt vector each. This means they are each only able to operate on the specified pins rather than any pin that supports pin change interrupts.  These will only work together with the listed pin numbers on the EnviroDIY Mayfly itself.
* [EnviroDIY PCInt_PCINT0](https://github.com/EnviroDIY/PcIntMod) - Will only work on pins D24-D31 (A00-A07)
* [EnviroDIY SoftwareSerial_PCINT12](https://github.com/EnviroDIY/SoftwareSerialMod) - Will only work on pins D8-D23
* [EnviroDIY SDI-12_PCINT3](https://github.com/EnviroDIY/Arduino-SDI-12/tree/Mayfly) - Will only work on pins D0-D7
